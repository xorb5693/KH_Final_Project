<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="shop">
	<select id="totalShop" resultType="int">
		select count(*) as cnt from
		product
	</select>

	<select id="shopList" parameterType="map" resultType="product">
		select *
		from
		(select rownum as rnum, n.* from
		(select pno, pname, pcontent, price , stock ,
		category,category2,category3,thumbnail
		from product order by pno desc)
		n)
		where rnum between #{start} and #{end}
	</select>

	<select id="shopSearchCount" parameterType="map"
		resultType="int">
		select count(*) as cnt from product where
		category=#{category} and category2=#{category2} and
		category3=#{category3} and stock>0 and pname like '%'||#{pname}||'%'
	</select>

	<select id="shopSearchList" parameterType="map"
		resultType="product">
		select * from
		(select rownum as rnum, n.* from
		(select pno, pname, pcontent, price , stock ,
		category,category2,category3,thumbnail
		from product where
		category=#{category} and category2=#{category2} and category3=#{category3} and stock>'0' and pname like '%'||#{pname}||'%'
		order by pno desc)
		n)
		where rnum between #{start} and #{end}
	</select>
	<select id="shopSearchCount2" parameterType="map"
		resultType="int">
		select count(*) as cnt from product where
		category=#{category} and category2=#{category2} and
		category3=#{category3} and stock>0
	</select>
	<select id="shopSearchList2" parameterType="map"
		resultType="product">
		select * from
		(select rownum as rnum, n.* from
		(select pno, pname, pcontent, price , stock ,
		category,category2,category3,thumbnail
		from product where
		category=#{category} and category2=#{category2} and category3=#{category3} and stock>'0'
		order by pno desc)
		n)
		where rnum between #{start} and #{end}
	</select>
	<select id="shopSelectOne" parameterType="int" resultType="product">
		select pno, pname, pcontent, price , stock ,
		category,category2,category3,thumbnail
		from product where pno=#{pno}
	</select>
	<select id="selectBasket" parameterType="int" resultType="product">
		select member_no as memberNo,pno,stock where member_no=${memberNo}
	</select>

</mapper>
